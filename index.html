<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Virtual Gift ğŸ’—</title>
  <link rel="stylesheet" href="styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Great+Vibes&display=swap" rel="stylesheet">
</head>
<body>
  <div class="heart-field" aria-hidden="true"></div>

  <div class="password-card fade-in">
    <div class="top-row">
      <h2><span class="heart-beat">ğŸ’—</span> Virtual Gift Idea ğŸ’Œ</h2>
      <div class="audio-control">
        <audio id="bg-music" loop>
          <source src="music.mp3" type="audio/mpeg">
        </audio>
        <button id="music-toggle" aria-pressed="false" aria-label="Play background music">â–¶ï¸</button>
      </div>
    </div>

    <div class="photo">
      <img src="couple.jpg" alt="us" />
    </div>

    <input type="password" id="display" placeholder="Enter Code" readonly aria-label="Pin display" />

    <div class="keypad" role="group" aria-label="Number keypad">
      <button class="key" aria-label="Digit 1">1</button>
      <button class="key" aria-label="Digit 2">2</button>
      <button class="key" aria-label="Digit 3">3</button>
      <button class="key" aria-label="Digit 4">4</button>
      <button class="key" aria-label="Digit 5">5</button>
      <button class="key" aria-label="Digit 6">6</button>
      <button class="key" aria-label="Digit 7">7</button>
      <button class="key" aria-label="Digit 8">8</button>
      <button class="key" aria-label="Digit 9">9</button>
      <button id="clear" aria-label="Clear">C</button>
      <button class="key" aria-label="Digit 0">0</button>
      <button id="enter" aria-label="Enter">â†©ï¸</button>
    </div>

    <p id="errorMsg" role="status" aria-live="polite"></p>
    <p class="credit">made with love ğŸ’•</p>
  </div>

  <!-- Modal (inline love content) -->
  <div id="loveModal" class="modal hidden" aria-hidden="true">
    <div class="modal-card card" role="dialog" aria-modal="true" aria-labelledby="loveTitle">
      <button class="modal-close" aria-label="Close">âœ•</button>
      <h2 id="loveTitle">Happy birthday! <svg class="heart-beat" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true"><path fill="#ff69b4" d="M12 21s-7-4.35-9.2-6.3C0.9 12.8 1.6 9.3 4.2 7.5 6.4 5.9 9.2 6.3 11 8c1.8-1.7 4.6-2.1 6.8-.5 2.6 1.8 3.3 5.3 1.4 7.9C19 16.65 12 21 12 21z"/></svg></h2>
      <div class="birthday-text">
        <h3>Hi, babe!</h3>
        <p>Wishing you a day filled with love, joy, and all the things that make you happiest ğŸ’•</p>
      </div>

      <video id="loveVideo" controls muted loop>
        <source src="couple.mp4" type="video/mp4">
      </video>

      <div class="nav-bar">
        <button class="nav-btn" data-target="profile">ğŸ‘¤ Profile</button>
        <button class="nav-btn" data-target="twentysix">ğŸ“¸ Twenty Six</button>
        <button class="nav-btn" data-target="readme">ğŸ“– Read Me</button>
      </div>

      <div id="content-area">
        <!-- Profile Section -->
        <div class="section hidden" id="profile">
          <img src="profile.jpg" alt="Profile Picture">
          <div class="text-part">
            <h3>A little about u ğŸ’•</h3>
            <p>You are the youngest one, a boy whoâ€™s very charming (just kidding ğŸ˜œ).
You always take care of your parents and are so responsible.
You always give your best in everything you do.
To me, you are kind, funny, and the most handsome person in the world! â¤ï¸</p>
          </div>
        </div>

        <!-- Twenty Six Section -->
        <div class="section hidden" id="twentysix">
          <h3>ğŸ’ Twenty Six Memories ğŸ’</h3>
          <div class="lomo-gallery">
            <div class="polaroid"><img src="lomo1.jpg" alt="Lomo Card 1"></div>
            <div class="polaroid"><img src="lomo2.jpg" alt="Lomo Card 2"></div>
            <div class="polaroid"><img src="lomo3.jpg" alt="Lomo Card 3"></div>
          </div>
        </div>

        <!-- Read Me Section -->
        <div class="section hidden" id="readme">
          <img src="readme.jpg" alt="Read Me Picture">
          <div class="text-part">
            <h3 class="typewriter">ğŸ“– Read Me</h3>
            <p>Every time you visit here, remember I love you no matter what happens. You're my safe place ğŸ’Œ</p>
            <p>I love every part of you, even your flaws.
                You always make me smile and fill my days with laughter.
                I canâ€™t imagine my life without you.
                Thank you for coming into my world and for all the love youâ€™ve given me.
                I hope to celebrate every birthday, and share every precious moment with you, from now until foreverğŸ’• </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Lightbox overlay -->
  <div id="lightbox" class="lightbox hidden" aria-hidden="true">
    <button class="lightbox-close" aria-label="Close">âœ•</button>
    <img src="" alt="" id="lightbox-img">
  </div>

  <!-- confetti lib (lightweight CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script>
    // --- Basic elements ---
    const display = document.getElementById("display");
    const keys = document.querySelectorAll(".key");
    const clear = document.getElementById("clear");
    const enter = document.getElementById("enter");
    const errorMsg = document.getElementById("errorMsg");
    const card = document.querySelector(".password-card");

    const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    keys.forEach((key) => {
      key.addEventListener("click", () => {
        if (display.value.length < 6) {
          display.value += key.textContent;
        }
      });
      key.tabIndex = 0;
    });

    clear.addEventListener("click", () => {
      display.value = "";
      errorMsg.textContent = "";
    });

    // --- Audio control (user toggled) ---
    const music = document.getElementById('bg-music');
    const musicToggle = document.getElementById('music-toggle');
    musicToggle.addEventListener('click', () => {
      if (music.paused) {
        music.play();
        musicToggle.textContent = 'â¸ï¸';
        musicToggle.setAttribute('aria-pressed', 'true');
      } else {
        music.pause();
        musicToggle.textContent = 'â–¶ï¸';
        musicToggle.setAttribute('aria-pressed', 'false');
      }
    });

    // --- Modal logic ---
    const modal = document.getElementById('loveModal');
    const modalClose = modal.querySelector('.modal-close');

    function showModal(){
      modal.classList.remove('hidden');
      modal.setAttribute('aria-hidden','false');
      // focus management
      modalClose.focus();
      // pause background audio if playing to keep focus on modal video
      if (!music.paused) music.pause();
    }

    function hideModal(){
      modal.classList.add('hidden');
      modal.setAttribute('aria-hidden','true');
      // return focus
      document.querySelector('.password-card .key')?.focus();
    }

    modalClose.addEventListener('click', hideModal);
    modal.addEventListener('click', (e)=>{ if(e.target === modal) hideModal(); });
    document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape' && !modal.classList.contains('hidden')) hideModal(); });

    // --- lightbox ---
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightbox-img');
    const lightboxClose = lightbox.querySelector('.lightbox-close');
    document.querySelectorAll('.lomo-gallery img').forEach(img => {
      img.addEventListener('click', ()=>{
        lightboxImg.src = img.src;
        lightboxImg.alt = img.alt || '';
        lightbox.classList.remove('hidden');
        lightbox.setAttribute('aria-hidden','false');
      });
    });
    lightboxClose.addEventListener('click', ()=>{ lightbox.classList.add('hidden'); lightbox.setAttribute('aria-hidden','true'); });
    lightbox.addEventListener('click', (e)=>{ if(e.target === lightbox) { lightbox.classList.add('hidden'); lightbox.setAttribute('aria-hidden','true'); } });

    // --- Celebration now shows modal instead of redirect ---
    function celebrateAndShow(){
      if (prefersReduced) { showModal(); return; }
      if (window.confetti) {
        confetti({ particleCount: 90, spread: 70, origin: { y: 0.6 }, colors: ['#ff8ec7','#ff69b4','#ffd6ec', '#fff2f9'] });
        setTimeout(()=> confetti({ particleCount: 50, spread: 100, origin: { y: 0.85 }}), 200);
      }
      // small delay so confetti visible
      setTimeout(() => showModal(), 600);
    }

    enter.addEventListener("click", () => {
      if (display.value === "1030") {
        celebrateAndShow();
      } else {
        errorMsg.textContent = "Wrong password ğŸ’”";
        display.value = "";
      }
    });

    // keyboard support for keypad
    document.addEventListener('keydown', (e) => {
      if (!display) return;
      if (/^\d$/.test(e.key) && display.value.length < 6) {
        display.value += e.key;
      } else if (e.key === 'Backspace') {
        e.preventDefault();
        display.value = display.value.slice(0, -1);
        errorMsg.textContent = '';
      } else if (e.key === 'Enter') {
        e.preventDefault();
        enter && enter.click();
      } else if (e.key.toLowerCase() === 'c') {
        clear && clear.click();
      }
    });

  </script>
</body>
</html>
